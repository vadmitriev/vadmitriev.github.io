(function(){"use strict";var t={8707:function(t,e,i){var r=i(9242),n=i(1020),a=i(3396);const o={class:"weather-widget-container"},s={class:"weather-widget-container__header"},d={class:"weather-widget__loader-wrapper"},c={class:"weather-widget__error-wrapper"};function l(t,e,i,n,l,p){const u=(0,a.up)("weather-header"),m=(0,a.up)("settings"),w=(0,a.up)("weather"),g=(0,a.up)("my-loader"),h=(0,a.up)("error-component"),y=(0,a.up)("my-card");return(0,a.wg)(),(0,a.iD)("div",o,[(0,a.Wm)(y,null,{default:(0,a.w5)((()=>[(0,a._)("div",s,[(0,a.Wm)(u,{showSettings:t.store.isSettingsOpen,onClick:t.toggleSettings},null,8,["showSettings","onClick"])]),t.store.isSettingsOpen?((0,a.wg)(),(0,a.j4)(m,{key:0})):((0,a.wg)(),(0,a.j4)(w,{key:1})),(0,a._)("div",d,[(0,a.wy)((0,a.Wm)(g,{visible:t.store.isLoading},null,8,["visible"]),[[r.F8,t.store.isLoading]])]),(0,a._)("div",c,[null!==t.store.error?((0,a.wg)(),(0,a.j4)(h,{key:0,error:t.store.error??""},null,8,["error"])):(0,a.kq)("",!0)])])),_:1})])}var p=i(7139);const u={class:"settings"},m=(0,a._)("div",{class:"header"}," Settings ",-1),w={class:"list-item"},g={class:"left"},h={class:"menu"},y={class:"name"},f={class:"add-city"},_=(0,a._)("span",{class:"title"}," Add Location ",-1);function b(t,e,i,r,n,o){const s=(0,a.up)("icon-menu"),d=(0,a.up)("icon-delete"),c=(0,a.up)("my-button"),l=(0,a.up)("draggable"),b=(0,a.up)("add-city");return(0,a.wg)(),(0,a.iD)("div",u,[m,(0,a.Wm)(l,{list:t.cities,"item-key":"id",class:"list","ghost-class":"ghost"},{item:(0,a.w5)((({element:e})=>[(0,a._)("li",w,[(0,a._)("div",g,[(0,a._)("div",h,[(0,a.Wm)(s)]),(0,a._)("span",y,(0,p.zw)(e.name),1)]),(0,a.Wm)(c,{size:"s",onClick:i=>t.store.removeCity(e)},{default:(0,a.w5)((()=>[(0,a.Wm)(d)])),_:2},1032,["onClick"])])])),_:1},8,["list"]),(0,a._)("div",f,[_,(0,a.Wm)(b)])])}i(1703);const v=(t,e)=>{localStorage.setItem(t,JSON.stringify(e))},x=t=>{const e=localStorage.getItem(t);return e?JSON.parse(e):null},k=(t,e)=>void 0!==t[e],C=t=>"fulfilled"===t.status;var S=i(6265),W=i.n(S);const z=W().create({baseURL:"https://api.openweathermap.org/data/2.5"});var E=z;const O="9a311be8dfe0163a5b9f860cbc9fb1e0",Z="metric";class D{static async getWeatherByCoords(t){return E.get("/weather",{params:{lat:t.lat,lon:t.lon,appId:O,units:Z}})}static async getWeatherByCityName(t){return E.get("/weather",{params:{q:t,appId:O,units:Z}})}}const j="weather-state",A=t=>{const e=Math.floor(t/22.5+.5),i=["N","NNE","NE","ENE","E","ESE","SE","SSE","S","SSW","SW","WSW","W","WNW","NW","NNW"];return i[e%16]},I=(t,e,i=!0)=>{const r=i?t:(t-32)/1.8,n=r-(14.55+.114*r)*(1-.01*e)-((2.5+.007*r)*(1-.01*e))**3-(15.9+.117*r)*(1-.01*e)**14;if(i)return n;const a=1.8*n;return a+32},L=t=>{switch(!0){case t<.5:return"Calm";case t<1.5:return"Light air";case t<3:return"Light breeze";case t<5:return"Gentle breeze";case t<8:return"Moderate breeze";case t<10.5:return"Fresh breeze";case t<13.5:return"Strong breeze";case t<16.5:return"Moderate gale";case t<20:return"Fresh gale";case t<23.5:return"Strong gale";case t<27.5:return"Whole gale";case t<31.5:return"Storm";default:return"Hurricane"}},M=t=>({id:t.sys.id,name:t.name,country:t.sys.country,temperature:Math.round(t.main.temp),feelsLike:t.main.feels_like,pressure:Math.round(t.main.pressure),humidity:Math.round(t.main.humidity),dewPoint:Math.round(I(t.main.temp,t.main.humidity)),visibility:Math.round(t.visibility/1e3),icon:t.weather[0].icon,weatherDescription:t.weather[0].description,wind:{speed:Math.round(t.wind.speed),direction:A(t.wind.deg),description:L(t.wind.speed),deg:t.wind.deg}}),F=navigator.geolocation,N=x(j),B=(0,n.Q_)({id:"weather",state:()=>({cities:N?.cities??[],isLoading:!1,error:null,errorAddCity:null,isSettingsOpen:N?.isSettingsOpen??!1}),actions:{setCities(t){this.cities=t},pushCity(t){this.cities.push(t)},async addCity(t){const e=this.cities.find((e=>e.name.toLowerCase()===t.toLowerCase()));if(e)this.setErrorAddCity(`City ${t} has already been added to the list`);else{this.setIsLoading(!0);try{const e=await this.loadDataForOneCity(t);e&&this.pushCity(e),this.resetErrorAddCity()}catch(i){i instanceof Error&&this.setErrorAddCity(i.message)}finally{this.setIsLoading(!1)}}},removeCity(t){this.cities=this.cities.filter((e=>e.id!==t.id))},setIsLoading(t){this.isLoading=t},setError(t){this.error=t},resetError(){this.error=null},setErrorAddCity(t){this.errorAddCity=t},resetErrorAddCity(){this.errorAddCity=null},setIsSettingsOpen(t){this.isSettingsOpen=t},toggleSettings(){this.isSettingsOpen=!this.isSettingsOpen},async loadDataForOneCity(t){try{let e;if(this.isLoading=!0,e=k(t,"lat")?await D.getWeatherByCoords(t):await D.getWeatherByCityName(t),k(e.data,"message"))throw new Error(e.data.message);return this.resetError(),M(e.data)}catch(e){if(e instanceof S.AxiosError){const t=e.response?.data.message||"Some error occured";throw new Error(t)}}finally{this.isLoading=!1}},async loadDataForAllCities(){const t=await Promise.allSettled(this.cities.map((async t=>this.loadDataForOneCity(t.name)))).then((t=>t.filter(C).map((t=>t.value))));this.setCities(t)},async getLocation(){const t=async t=>{const e={lat:t.coords.latitude,lon:t.coords.longitude},i=await this.loadDataForOneCity(e);i&&this.pushCity(i)};F.getCurrentPosition(t)}}});var P=i(681),$=i(6072);const U={class:"add-city-wrapper"},q={class:"add-city__controls"};function H(t,e,i,n,o,s){const d=(0,a.up)("enter-outlined"),c=(0,a.up)("my-button");return(0,a.wg)(),(0,a.iD)("div",U,[(0,a.wy)((0,a._)("div",{class:"add-city__error"},(0,p.zw)(t.store.errorAddCity),513),[[r.F8,t.store.errorAddCity&&t.showError]]),(0,a._)("div",q,[(0,a._)("input",{placeholder:"Add Location",ref:"input",onInput:e[0]||(e[0]=(...e)=>t.handleInput&&t.handleInput(...e)),onKeyup:e[1]||(e[1]=(0,r.D2)(((...e)=>t.handleAdd&&t.handleAdd(...e)),["enter"]))},null,544),(0,a.Wm)(c,{onClick:t.handleAdd},{default:(0,a.w5)((()=>[(0,a.Wm)(d)])),_:1},8,["onClick"])])])}var V=i(4870),T=i(1200);function R(t,e,i,r,n,o){return(0,a.wg)(),(0,a.iD)("div",{class:(0,p.C_)(["my-button",{small:"s"===t.size,middle:"m"===t.size,large:"l"===t.size}])},[(0,a.WI)(t.$slots,"default")],2)}var J=(0,a.aZ)({name:"my-button",props:{size:{type:String,default:"m"}}}),K=i(89);const G=(0,K.Z)(J,[["render",R]]);var Q=G;const Y={class:"my-card"};function X(t,e,i,r,n,o){return(0,a.wg)(),(0,a.iD)("div",Y,[(0,a.WI)(t.$slots,"default")])}var tt=(0,a.aZ)({name:"my-card"});const et=(0,K.Z)(tt,[["render",X]]);var it=et;const rt={class:"my-loader"},nt=(0,a._)("div",{class:"my-loader__dot"},null,-1),at=(0,a._)("div",{class:"my-loader__dot"},null,-1),ot=(0,a._)("div",{class:"my-loader__dot"},null,-1),st=(0,a._)("div",{class:"my-loader__dot"},null,-1),dt=[nt,at,ot,st];function ct(t,e,i,n,o,s){return(0,a.wy)(((0,a.wg)(),(0,a.iD)("div",rt,dt,512)),[[r.F8,t.visible]])}var lt=(0,a.aZ)({name:"my-loader",props:{visible:{type:Boolean,required:!0}}});const pt=(0,K.Z)(lt,[["render",ct]]);var ut=pt,mt=(0,a.aZ)({name:"add-city",components:{EnterOutlined:T.Z,MyButton:Q},data(){return{inputValue:"",showError:!0}},setup(){const t=B(),e=(0,V.iH)(null);return{input:e,store:t}},methods:{async handleAdd(){await this.store.addCity(this.inputValue),this.showError=!0,this.inputValue="",this.$refs.input.value=""},focusInput(){this.$refs.input.focus()},handleInput(t){this.showError=!1,this.inputValue=t.target.value}},mounted(){this.focusInput()}});const wt=(0,K.Z)(mt,[["render",H]]);var gt=wt,ht=i(6983),yt=i.n(ht),ft=(0,a.aZ)({name:"settings-view",components:{IconDelete:P.Z,IconMenu:$.Z,AddCity:gt,draggable:yt(),MyButton:Q},setup(){const t=B();return{store:t,cities:(0,a.Fl)((()=>t.cities))}}});const _t=(0,K.Z)(ft,[["render",b]]);var bt=_t;const vt={class:"weather-wrapper"},xt={key:0,class:"empty"},kt=(0,a._)("div",{class:"title"}," It looks like there's nothing here ",-1),Ct={class:"add-city"},St={key:1,class:"weather-list"};function Wt(t,e,i,r,n,o){const s=(0,a.up)("add-city"),d=(0,a.up)("weather-card");return(0,a.wg)(),(0,a.iD)("div",vt,[0===t.store.cities.length?((0,a.wg)(),(0,a.iD)("div",xt,[kt,(0,a._)("div",Ct,[(0,a.Wm)(s)])])):((0,a.wg)(),(0,a.iD)("ul",St,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.store.cities,(t=>((0,a.wg)(),(0,a.iD)("li",{key:t.id,class:"city"},[(0,a.Wm)(d,{city:t},null,8,["city"])])))),128))]))])}const zt={class:"weather-card__city-wrapper"},Et={class:"weather-card__city_wrapper_title"},Ot={class:"weather-card__weather"},Zt=["src"],Dt={class:"weather-card__weather__deg"},jt={class:"weather-card__description"},At={class:"weather-card__description_weather"},It={class:"weather-card__params"},Lt={class:"arrow-icon"};function Mt(t,e,i,r,n,o){const s=(0,a.up)("icon-arrow"),d=(0,a.up)("icon-pressure");return(0,a.wg)(),(0,a.iD)("div",zt,[(0,a._)("div",Et,(0,p.zw)(t.city.name)+", "+(0,p.zw)(t.city.country),1),(0,a._)("div",Ot,[(0,a._)("img",{src:t.imgUrl,alt:"weather icon"},null,8,Zt),(0,a._)("div",Dt,[(0,a._)("strong",null,(0,p.zw)(t.city.temperature)+"°C",1)])]),(0,a._)("div",jt,[(0,a.Uk)(" Feels like "+(0,p.zw)(t.city.feelsLike)+"°C. ",1),(0,a._)("span",At,(0,p.zw)(t.city.weatherDescription)+". "+(0,p.zw)(t.city.wind.description),1)]),(0,a._)("div",It,[(0,a._)("p",null,[(0,a._)("span",Lt,[(0,a.Wm)(s,{style:(0,p.j5)(t.windIconStyle)},null,8,["style"])]),(0,a.Uk)(" "+(0,p.zw)(t.city.wind.speed)+" m/s "+(0,p.zw)(t.city.wind.direction),1)]),(0,a._)("p",null,[(0,a.Wm)(d),(0,a.Uk)(" "+(0,p.zw)(t.city.pressure)+" hPa ",1)]),(0,a._)("p",null," Humidity: "+(0,p.zw)(t.city.humidity)+"% ",1),(0,a._)("p",null," Dew point: "+(0,p.zw)(t.city.dewPoint)+"°C ",1),(0,a._)("p",null," Visibility: "+(0,p.zw)(t.city.visibility)+" km ",1)])])}var Ft=i(170),Nt=i(7180),Bt=(0,a.aZ)({name:"weather-card",components:{IconPressure:Ft.Z,IconArrow:Nt.Z},data(){const t=`http://openweathermap.org/img/wn//${this.city.icon}@2x.png`,e=`transform: rotate(${this.city.wind.deg+180}deg);`;return{imgUrl:t,windIconStyle:e}},props:{city:{type:Object,required:!0}}});const Pt=(0,K.Z)(Bt,[["render",Mt]]);var $t=Pt;const Ut={class:"weather-header-wrapper"};function qt(t,e,i,n,o,s){const d=(0,a.up)("setting-outlined"),c=(0,a.up)("my-button"),l=(0,a.up)("close-outlined");return(0,a.wg)(),(0,a.iD)("div",Ut,[(0,a.wy)((0,a.Wm)(c,{class:"btn"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{class:"icon"})])),_:1},512),[[r.F8,!t.showSettings]]),(0,a.wy)((0,a.Wm)(c,{class:"btn"},{default:(0,a.w5)((()=>[(0,a.wy)((0,a.Wm)(l,{class:"icon"},null,512),[[r.F8,t.showSettings]])])),_:1},512),[[r.F8,t.showSettings]])])}var Ht=i(7098),Vt=i(5599),Tt=(0,a.aZ)({name:"weather-header",components:{SettingOutlined:Ht.Z,CloseOutlined:Vt.Z,MyButton:Q},props:{showSettings:{type:Boolean,required:!0}}});const Rt=(0,K.Z)(Tt,[["render",qt]]);var Jt=Rt;const Kt={class:"error-wrapper"},Gt=(0,a._)("div",{class:"error-title"}," Произошла ошибка ",-1),Qt={class:"error-content"};function Yt(t,e,i,r,n,o){return(0,a.wg)(),(0,a.iD)("div",Kt,[Gt,(0,a._)("div",Qt,(0,p.zw)(t.error),1)])}var Xt=(0,a.aZ)({name:"error-component",props:{error:{type:String}}});const te=(0,K.Z)(Xt,[["render",Yt]]);var ee=te,ie=(0,a.aZ)({name:"weather-view",components:{WeatherCard:$t,AddCity:gt},setup(){const t=B();return{store:t}},mounted(){this.store.cities.length||this.store.getLocation(),this.store.loadDataForAllCities()}});const re=(0,K.Z)(ie,[["render",Wt]]);var ne=re,ae=(0,a.aZ)({name:"weather-widget",components:{Weather:ne,Settings:bt,WeatherHeader:Jt,ErrorComponent:ee,MyCard:it,MyLoader:ut},setup(){const t=B();return t.$subscribe(((t,e)=>{v(j,e)})),{store:t}},methods:{toggleSettings(){this.store.toggleSettings(),this.store.resetError(),this.store.resetErrorAddCity()}}}),oe='@import"https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap";.my-button{border:none;background-color:rgba(0,0,0,0);cursor:pointer;border-radius:50%;padding:5px}.my-button.small{font-size:16px}.my-button.middle{font-size:25px}.my-button.big{font-size:40px}.my-button:hover{color:#409eff}.my-card{background:#fff;border-radius:.4em;box-shadow:.3em .3em .7em rgba(0,0,0,.0823529412);transition:border .5s cubic-bezier(0.175, 0.885, 0.32, 1.275);border:#fafafa .2em solid;position:absolute;min-width:100%;min-height:100%;top:20px;left:20px;padding:20px}.my-loader{position:relative;display:flex;align-items:center;justify-content:center;width:50px;height:50px}.my-loader__dot{position:relative;display:flex;align-items:center;height:100%;width:25%;transform-origin:center top}.my-loader__dot::after{content:"";display:block;width:100%;height:25%;border-radius:50%;background-color:#474554}.my-loader__dot:first-child{-webkit-animation:swing 1.2s linear infinite;animation:swing 1.2s linear infinite}.my-loader__dot:last-child{-webkit-animation:swing2 1.2s linear infinite;animation:swing2 1.2s linear infinite}@-webkit-keyframes swing{0%{transform:rotate(0deg);-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out}25%{transform:rotate(70deg);-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}50%{transform:rotate(0deg);-webkit-animation-timing-function:linear;animation-timing-function:linear}}@keyframes swing{0%{transform:rotate(0deg);-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out}25%{transform:rotate(70deg);-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}50%{transform:rotate(0deg);-webkit-animation-timing-function:linear;animation-timing-function:linear}}@-webkit-keyframes swing2{0%{transform:rotate(0deg);-webkit-animation-timing-function:linear;animation-timing-function:linear}50%{transform:rotate(0deg);-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out}75%{transform:rotate(-70deg);-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}}@keyframes swing2{0%{transform:rotate(0deg);-webkit-animation-timing-function:linear;animation-timing-function:linear}50%{transform:rotate(0deg);-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out}75%{transform:rotate(-70deg);-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}}.add-city-wrapper .add-city__error{color:#f56c6c;background-color:#fef0f0;margin-bottom:10px;text-align:center;padding:5px;display:flex;justify-content:center;align-items:center}.add-city-wrapper .add-city__controls{display:flex;justify-content:center;gap:5px}.add-city-wrapper .add-city__controls input{width:100%;padding:10px}.add-city-wrapper .add-city__controls input:focus{outline:none;border:1px solid #409eff;box-shadow:0 0 10px #719ece}.error-wrapper{position:relative;width:100%;height:100%;display:flex;justify-content:center;align-items:center;flex-direction:column}.error-wrapper .error-title{font-weight:700;font-size:large;margin:10px 5px}.error-wrapper .error-content{font-weight:500;margin-bottom:10px}.weather-card__city-wrapper{position:relative}.weather-card__city-wrapper .weather-card__city_wrapper_title{font-size:large;font-weight:600}.weather-card__city-wrapper .weather-card__weather{display:flex;align-items:center;width:100%;min-height:30%;margin-bottom:15px}.weather-card__city-wrapper .weather-card__weather .weather-card__weather__deg{padding:20px;font-size:30px;font-weight:bold}.weather-card__city-wrapper .weather-card__description{margin-bottom:10px}.weather-card__city-wrapper .weather-card__description .weather-card__description_weather{display:inline-block}.weather-card__city-wrapper .weather-card__description .weather-card__description_weather::first-letter{text-transform:uppercase}.weather-card__city-wrapper .weather-card__params{display:grid;grid-template-columns:1fr 1fr;grid-template-rows:1fr 1fr 1fr;gap:16px}.weather-card__city-wrapper .weather-card__params .arrow-icon{font-size:18px}.weather-header-wrapper{display:flex;justify-content:flex-end;position:absolute;top:0;right:0;z-index:10;padding:10px 10px 0 0}.settings .header{font-size:large;font-weight:bold;margin-bottom:15px}.settings .list{list-style:none;max-height:300px;overflow:hidden;overflow-y:auto}.settings .list .list-item{margin-bottom:5px;padding:10px;display:flex;justify-content:space-between;box-shadow:0 2px 12px 0 rgba(0,0,0,.1)}.settings .list .list-item .left{display:flex;justify-content:center;align-items:center}.settings .list .list-item .left .menu{margin-right:10px;cursor:move}.settings .list .list-item .left .name{padding:5px}.settings .add-city{margin-top:30px}.settings .add-city .title{display:inline-block;font-weight:bold;margin-bottom:10px}.weather-wrapper{min-height:200px}.weather-wrapper .empty{display:flex;flex-direction:column;justify-content:center;align-items:center}.weather-wrapper .empty .title{margin:15% 0;text-align:center;font-size:25px;font-weight:bold}.weather-wrapper .empty .add-city{display:flex;justify-content:center}.weather-wrapper .weather-list{list-style:none}.weather-wrapper .weather-list .city{margin-bottom:30px}*{box-sizing:border-box;margin:0;padding:0;font-family:"Roboto",sans-serif}.weather-widget-container{position:relative;max-width:300px;min-width:100px;min-height:100px;padding:10px}.weather-widget__loader-wrapper,.weather-widget__error-wrapper{display:flex;justify-content:center;align-items:center;z-index:10;isolation:isolate}.weather-widget__loader-wrapper{position:absolute;top:20%;left:40%}';const se=(0,K.Z)(ae,[["render",l],["styles",[oe]]]);var de=se;const ce=(0,r.MW)(de),le=(0,n.WB)(),pe=(0,r.ri)(de);pe.use(le),customElements.define("weather-widget",ce)}},e={};function i(r){var n=e[r];if(void 0!==n)return n.exports;var a=e[r]={exports:{}};return t[r].call(a.exports,a,a.exports,i),a.exports}i.m=t,function(){var t=[];i.O=function(e,r,n,a){if(!r){var o=1/0;for(l=0;l<t.length;l++){r=t[l][0],n=t[l][1],a=t[l][2];for(var s=!0,d=0;d<r.length;d++)(!1&a||o>=a)&&Object.keys(i.O).every((function(t){return i.O[t](r[d])}))?r.splice(d--,1):(s=!1,a<o&&(o=a));if(s){t.splice(l--,1);var c=n();void 0!==c&&(e=c)}}return e}a=a||0;for(var l=t.length;l>0&&t[l-1][2]>a;l--)t[l]=t[l-1];t[l]=[r,n,a]}}(),function(){i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,{a:e}),e}}(),function(){i.d=function(t,e){for(var r in e)i.o(e,r)&&!i.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){var t={143:0};i.O.j=function(e){return 0===t[e]};var e=function(e,r){var n,a,o=r[0],s=r[1],d=r[2],c=0;if(o.some((function(e){return 0!==t[e]}))){for(n in s)i.o(s,n)&&(i.m[n]=s[n]);if(d)var l=d(i)}for(e&&e(r);c<o.length;c++)a=o[c],i.o(t,a)&&t[a]&&t[a][0](),t[a]=0;return i.O(l)},r=self["webpackChunkweather_widget"]=self["webpackChunkweather_widget"]||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))}();var r=i.O(void 0,[998],(function(){return i(8707)}));r=i.O(r)})();
//# sourceMappingURL=app.997e3146.js.map